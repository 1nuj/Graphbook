{"name":"Cross Entropy Loss","title_is_latex":false,"type":"COMPOSITE_OPERATION","inputs":[{"name":"Predicted Probs","primitive_name":"new_inp","is_latex":false},{"name":"Expected Labels","primitive_name":"i_0_Objective Function","is_latex":false},{"name":"Classes","primitive_name":"i_0_Objective Function"}],"input_order":[0,1,2],"subgraph_input_order":[0,1,2],"outputs":[{"name":"Loss","primitive_name":"new_out","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"subgraph_output_order":[0,1,2],"operations":[{"name":"get_shape","title_is_latex":false,"primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":457,"y":266},"inputs":[{"name":"input","primitive_name":"input","is_latex":false}],"input_order":[0],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{input}_shape_is_{shape}","{shape}_has_one_dimension","{shape}_is_greater_than_or_equal_to_zero","{shape}_data_type_is_integer","{input}_is_array"]},{"name":"broadcast_to_shape","title_is_latex":false,"primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":904,"y":228},"inputs":[{"name":"target","data":2.71828,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE","is_latex":false},{"name":"shape","primitive_name":"shape","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["every_dimension_size_of_{target}_is_less_than_or_equal_to_the_corresponding_dimension_size_of_{result}","{target}_shape_size_is_less_than_or_equal_to_{result}_shape_size","{result}_shape_is_{shape}","{result}_data_type_is_the_same_as_{target}","every_dimension_size_of_{target}_is_less_than_or_equal_to_the_corresponding_value_of_array_{shape}","{target}_shape_size_is_less_than_or_equal_to_{shape}_size","{shape}_has_one_dimension","{shape}_data_type_is_integer"]},{"name":"element_wise_logarithm","title_is_latex":false,"primitive_name":"element_wise_logarithm","type":"PRIMITIVE_OPERATION","position":{"x":1477,"y":189},"inputs":[{"name":"base","primitive_name":"base","is_latex":false},{"name":"argument","primitive_name":"argument","is_latex":false}],"input_order":[1,0],"outputs":[{"name":"exponent","primitive_name":"exponent","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{exponent}_shape_is_the_same_as_{argument}","{argument}_shape_is_the_same_as_{base}","{exponent}_data_type_is_decimal","{argument}_data_type_is_decimal","{base}_data_type_is_decimal"]},{"name":"expand_one_dimension","title_is_latex":false,"primitive_name":"expand_one_dimension","type":"PRIMITIVE_OPERATION","position":{"x":458,"y":606},"inputs":[{"name":"input","primitive_name":"input","is_latex":false},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{output}_data_type_is_the_same_as_{input}","{output}_has_one_more_dimension_than_{input}","{dimension_index}_is_less_than_or_equal_to_{input}_number_of_dimensions","{dimension_index}_is_greater_than_or_equal_to_zero","{dimension_index}_data_type_is_integer","{dimension_index}_is_scalar"]},{"name":"index_text_to_condensed_one_hot","title_is_latex":false,"primitive_name":"index_text_to_condensed_one_hot","type":"PRIMITIVE_OPERATION","position":{"x":975,"y":760},"inputs":[{"name":"text","primitive_name":"text","is_latex":false},{"name":"vocabulary","primitive_name":"vocabulary","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"condensed_one_hot_index","primitive_name":"condensed_one_hot_index","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{condensed_one_hot_index}_is_greater_than_or_equal_to_zero","{condensed_one_hot_index}_data_type_is_integer","{vocabulary}_has_one_dimension","{vocabulary}_data_type_is_text","{text}_data_type_is_text"]},{"name":"slice","title_is_latex":false,"primitive_name":"slice","type":"PRIMITIVE_OPERATION","position":{"x":1543,"y":759},"inputs":[{"name":"array","primitive_name":"array","is_latex":false},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE","is_latex":false},{"name":"start_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"start_index","flow_state":"BOOT_SOURCE","is_latex":false},{"name":"end_index","data":2,"shape":[],"type":"INTEGER","primitive_name":"end_index","flow_state":"BOOT_SOURCE","is_latex":false}],"input_order":[0,1,2,3],"outputs":[{"name":"sliced_array","primitive_name":"sliced_array","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{sliced_array}_data_type_is_the_same_as_{array}","{start_index}_is_less_than_{end_index}","{sliced_array}_is_array","{end_index}_is_greater_than_zero","{end_index}_is_scalar","{end_index}_data_type_is_integer","{start_index}_is_greater_than_or_equal_to_zero","{start_index}_is_scalar","{start_index}_data_type_is_integer","{dimension_index}_is_scalar","{dimension_index}_data_type_is_integer","{array}_is_array"]},{"name":"parse_decimal","title_is_latex":false,"primitive_name":"parse_decimal","type":"PRIMITIVE_OPERATION","position":{"x":1934,"y":498},"inputs":[{"name":"input","primitive_name":"input","is_latex":false}],"input_order":[0],"outputs":[{"name":"output","primitive_name":"output","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{output}_shape_is_the_same_as_{input}","{output}_data_type_is_decimal"]},{"name":"element_wise_multiply","title_is_latex":false,"primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":2372,"y":190},"inputs":[{"name":"left_array","primitive_name":"left_array","is_latex":false},{"name":"right_array","primitive_name":"right_array","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{multiplied_array}_shape_is_the_same_as_{right_array}","{multiplied_array}_data_type_is_the_same_as_{right_array}","{right_array}_shape_is_the_same_as_{left_array}","{right_array}_data_type_is_the_same_as_{left_array}","{left_array}_data_type_is_integer_or_decimal"]},{"name":"sum","title_is_latex":false,"primitive_name":"sum","type":"PRIMITIVE_OPERATION","position":{"x":2989,"y":190},"inputs":[{"name":"array","primitive_name":"array","is_latex":false},{"name":"dimension_index","data":1,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE","is_latex":false},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"sum_result","primitive_name":"sum_result","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{sum_result}_data_type_is_the_same_as_{array}","{dimension_index}_is_less_than_{array}_number_of_dimensions","{keep_dimension}_is_scalar","{keep_dimension}_data_type_is_boolean","{dimension_index}_is_greater_than_or_equal_to_zero","{dimension_index}_is_scalar","{dimension_index}_data_type_is_integer","{array}_is_array","{array}_data_type_is_integer_or_decimal"]},{"name":"get_shape_1","title_is_latex":false,"primitive_name":"get_shape","type":"PRIMITIVE_OPERATION","position":{"x":3387,"y":472},"inputs":[{"name":"input","primitive_name":"input","is_latex":false}],"input_order":[0],"outputs":[{"name":"shape","primitive_name":"shape","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{input}_shape_is_{shape}","{shape}_has_one_dimension","{shape}_is_greater_than_or_equal_to_zero","{shape}_data_type_is_integer","{input}_is_array"]},{"name":"broadcast_to_shape_1","title_is_latex":false,"primitive_name":"broadcast_to_shape","type":"PRIMITIVE_OPERATION","position":{"x":3879,"y":434},"inputs":[{"name":"target","data":-1.0,"shape":[],"type":"DECIMAL","primitive_name":"target","flow_state":"BOOT_SOURCE","is_latex":false},{"name":"shape","primitive_name":"shape","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"result","primitive_name":"result","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["every_dimension_size_of_{target}_is_less_than_or_equal_to_the_corresponding_dimension_size_of_{result}","{target}_shape_size_is_less_than_or_equal_to_{result}_shape_size","{result}_shape_is_{shape}","{result}_data_type_is_the_same_as_{target}","every_dimension_size_of_{target}_is_less_than_or_equal_to_the_corresponding_value_of_array_{shape}","{target}_shape_size_is_less_than_or_equal_to_{shape}_size","{shape}_has_one_dimension","{shape}_data_type_is_integer"]},{"name":"element_wise_multiply_1","title_is_latex":false,"primitive_name":"element_wise_multiply","type":"PRIMITIVE_OPERATION","position":{"x":4282,"y":189},"inputs":[{"name":"left_array","primitive_name":"left_array","is_latex":false},{"name":"right_array","primitive_name":"right_array","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"multiplied_array","primitive_name":"multiplied_array","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{multiplied_array}_shape_is_the_same_as_{right_array}","{multiplied_array}_data_type_is_the_same_as_{right_array}","{right_array}_shape_is_the_same_as_{left_array}","{right_array}_data_type_is_the_same_as_{left_array}","{left_array}_data_type_is_integer_or_decimal"]},{"name":"mean","title_is_latex":false,"primitive_name":"mean","type":"PRIMITIVE_OPERATION","position":{"x":4800,"y":190},"inputs":[{"name":"array","primitive_name":"array","is_latex":false},{"name":"dimension_index","data":0,"shape":[],"type":"INTEGER","primitive_name":"dimension_index","flow_state":"BOOT_SOURCE","is_latex":false},{"name":"keep_dimension","data":false,"shape":[],"type":"BOOLEAN","primitive_name":"keep_dimension","flow_state":"BOOT_SOURCE","is_latex":false}],"input_order":[0,1],"outputs":[{"name":"mean_result","primitive_name":"mean_result","flow_state":"UNBOUND","is_latex":false}],"output_order":[0],"assertions":["{mean_result}_data_type_is_the_same_as_{array}","{dimension_index}_is_less_than_{array}_number_of_dimensions","{keep_dimension}_is_scalar","{keep_dimension}_data_type_is_boolean","{dimension_index}_is_greater_than_or_equal_to_zero","{dimension_index}_is_scalar","{dimension_index}_data_type_is_integer","{array}_is_array","{array}_data_type_is_integer_or_decimal"]}],"links":[{"source":{"operation":"this","data":"Predicted Probs"},"sink":{"operation":"get_shape","data":"input"},"control_points":[]},{"source":{"operation":"get_shape","data":"shape"},"sink":{"operation":"broadcast_to_shape","data":"shape"},"control_points":[]},{"source":{"operation":"broadcast_to_shape","data":"result"},"sink":{"operation":"element_wise_logarithm","data":"base"},"control_points":[]},{"source":{"operation":"this","data":"Predicted Probs"},"sink":{"operation":"element_wise_logarithm","data":"argument"},"control_points":[{"x":1333,"y":101}]},{"source":{"operation":"element_wise_logarithm","data":"exponent"},"sink":{"operation":"element_wise_multiply","data":"left_array"},"control_points":[]},{"source":{"operation":"element_wise_multiply","data":"multiplied_array"},"sink":{"operation":"sum","data":"array"},"control_points":[]},{"source":{"operation":"mean","data":"mean_result"},"sink":{"operation":"this","data":"Loss"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"element_wise_multiply_1","data":"left_array"},"control_points":[]},{"source":{"operation":"broadcast_to_shape_1","data":"result"},"sink":{"operation":"element_wise_multiply_1","data":"right_array"},"control_points":[]},{"source":{"operation":"sum","data":"sum_result"},"sink":{"operation":"get_shape_1","data":"input"},"control_points":[]},{"source":{"operation":"get_shape_1","data":"shape"},"sink":{"operation":"broadcast_to_shape_1","data":"shape"},"control_points":[]},{"source":{"operation":"element_wise_multiply_1","data":"multiplied_array"},"sink":{"operation":"mean","data":"array"},"control_points":[]},{"source":{"operation":"this","data":"Classes"},"sink":{"operation":"index_text_to_condensed_one_hot","data":"vocabulary"},"control_points":[{"x":374,"y":852}]},{"source":{"operation":"this","data":"Expected Labels"},"sink":{"operation":"expand_one_dimension","data":"input"},"control_points":[]},{"source":{"operation":"expand_one_dimension","data":"output"},"sink":{"operation":"index_text_to_condensed_one_hot","data":"text"},"control_points":[]},{"source":{"operation":"index_text_to_condensed_one_hot","data":"condensed_one_hot_index"},"sink":{"operation":"slice","data":"array"},"control_points":[]},{"source":{"operation":"slice","data":"sliced_array"},"sink":{"operation":"parse_decimal","data":"input"},"control_points":[]},{"source":{"operation":"parse_decimal","data":"output"},"sink":{"operation":"element_wise_multiply","data":"right_array"},"control_points":[]}]}